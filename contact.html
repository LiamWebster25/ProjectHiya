<!-- -------------------------------------------------------  
Final Project  Written by: (Liam Webster - 2265137 and Rowan Lajoie - 2179433)  
*“Liam: HTML, CSS | Rowan: JS” 
For “Internet Programming” Section (00001)– Fall 2023 
--------------------------------------------------------  -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <header>
    <a href="home.html"><img src="logo.png" alt="Home" /></a>
    <nav>
      <p>
        <a href="home.html">Home</a>&nbsp; <a href="about.html">About</a>&nbsp;
        <a href="schedule.html">Schedule</a> &nbsp;
        <a href="prices.html">Prices</a> &nbsp;
        <a href="contact.html">Contact</a>
      </p>
    </nav>
  </header>
  <body>
    <div class="bg-container">
      <div class="container">
        <h2>Contact Us!</h2>
        <form onsubmit="contact(event)" class="contact-form" method="POST">
          <input type="text" name="name" placeholder="Name" />
          <input type="email" name="email" placeholder="Email" />
          <textarea name="message" placeholder="Message"></textarea>
          <br />
          <button type="submit">Send</button>
        </form>
        <p>OR email us at <a href="mailto:1234@hiya.com">1234@hiya.com</a></p>
      </div>
    </div>
    <footer>
      <p>&copy; Hiya! 2023 - <a href="admin.html">Admin</a></p>
    </footer>

    <script>
      function fonts() {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "fonts.json", true);
        xhr.onload = function () {
          if (xhr.status >= 200 && xhr.status < 400) {
            var data = JSON.parse(xhr.responseText);

            // Extract font URLs from the JSON data
            var font1 = data[0].font1;
            var font2 = data[0].font2;

            // Create link elements for the fonts
            var link1 = document.createElement("link");
            var link2 = document.createElement("link");

            link1.rel = "stylesheet";
            link1.href = font1;

            link2.rel = "stylesheet";
            link2.href = font2;

            // Append the link elements to the head
            var head = document.getElementsByTagName("head")[0];
            head.appendChild(link1);
            head.appendChild(link2);
          }
        };

        xhr.send();
      }

      window.onload = function () {
        fonts();
      };
      function contact(event) {
        event.preventDefault();

        //Gets values at index 0 so that it's reusable
        var nameOfClient = document.getElementsByName("name")[0].value;
        var emailAddy = document.getElementsByName("email")[0].value;
        var messageToSend = document.getElementsByName("message")[0].value;

        // Fields cannot be empty
        if (!nameOfClient || !emailAddy || !messageToSend) {
          alert("Please fill out all fields.");
          return;
        }

        // Email validation
        var emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
        if (!emailPattern.test(emailAddy)) {
          alert("Please enter a valid email address.");
          return;
        }
        //Provides alert to the user
        alert("Your message has been submitted!");

        // Update admin page using concept called localStorage
        var messages = JSON.parse(localStorage.getItem("messages")) || [];
        messages.push({
          name: nameOfClient,
          email: emailAddy,
          message: messageToSend,
        });
        //set's item as JSON string with the messages variable that was created above
        localStorage.setItem("messages", JSON.stringify(messages));

        // Call the displayMessage function directly to update admin page immediately
        displayMessage({
          name: nameOfClient,
          email: emailAddy,
          message: messageToSend,
        });
      }
    </script>
  </body>
</html>
